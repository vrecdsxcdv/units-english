# üöÄ –ò–ò –†–µ–ø–µ—Ç–∏—Ç–æ—Ä - –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

## ‚ö° –ó–∞–ø—É—Å–∫ –∑–∞ 2 –º–∏–Ω—É—Ç—ã

### –®–∞–≥ 1: –ü–æ–ª—É—á–∏—Ç–µ OpenAI API –∫–ª—é—á (1 –º–∏–Ω—É—Ç–∞)

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ https://platform.openai.com
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **API Keys**
3. –ù–∞–∂–º–∏—Ç–µ **Create new secret key**
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–ª—é—á: `sk-...`

**–í–∞–∂–Ω–æ:** –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∫–ª—é—á –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ!

---

### –®–∞–≥ 2: –î–æ–±–∞–≤—å—Ç–µ –∫–ª—é—á –≤ .env (30 —Å–µ–∫—É–Ω–¥)

```bash
# –û—Ç–∫—Ä–æ–π—Ç–µ .env —Ñ–∞–π–ª
echo "OPENAI_API_KEY=sk-–≤–∞—à-–∫–ª—é—á-–∑–¥–µ—Å—å" >> .env
```

–ò–ª–∏ –≤—Ä—É—á–Ω—É—é –¥–æ–±–∞–≤—å—Ç–µ –≤ `.env`:

```env
OPENAI_API_KEY=sk-proj-xxxxxxxxxxxxx
```

---

### –®–∞–≥ 3: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ OpenAI SDK (30 —Å–µ–∫—É–Ω–¥)

```bash
npm install openai
```

---

### –®–∞–≥ 4: –ó–∞–ø—É—Å—Ç–∏—Ç–µ Next.js (10 —Å–µ–∫—É–Ω–¥)

```bash
npm run dev
```

---

### –®–∞–≥ 5: –û—Ç–∫—Ä–æ–π—Ç–µ —á–∞—Ç (10 —Å–µ–∫—É–Ω–¥)

–ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞: **http://localhost:3001/tutor**

**üéâ –ì–æ—Ç–æ–≤–æ!** –ù–∞—á–Ω–∏—Ç–µ –æ–±—â–∞—Ç—å—Å—è —Å –ò–ò —Ä–µ–ø–µ—Ç–∏—Ç–æ—Ä–æ–º!

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### –¢–µ—Å—Ç 1: General Mode

```
–í—ã: Explain Present Simple
–†–µ–ø–µ—Ç–∏—Ç–æ—Ä: Present Simple ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ–µ –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è...
```

### –¢–µ—Å—Ç 2: Lesson Mode

```
–í—ã: –î–∞–π —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –Ω–∞ –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏–µ
–†–µ–ø–µ—Ç–∏—Ç–æ—Ä: –í–æ—Ç —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ: Fill in the gaps...
```

### –¢–µ—Å—Ç 3: Practice Mode

```
You: Let's talk about hobbies
Tutor: Great! What do you like to do in your free time?
```

---

## üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å

### GPT-4o-mini (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

- **$0.15** –∑–∞ 1M –≤—Ö–æ–¥—è—â–∏—Ö —Ç–æ–∫–µ–Ω–æ–≤
- **$0.60** –∑–∞ 1M –∏—Å—Ö–æ–¥—è—â–∏—Ö —Ç–æ–∫–µ–Ω–æ–≤
- **~$0.0003** –∑–∞ –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å (~800 —Ç–æ–∫–µ–Ω–æ–≤)
- **~$0.30** –∑–∞ 1000 –∑–∞–ø—Ä–æ—Å–æ–≤

**–ü—Ä–∏–º–µ—Ä:**

- 10,000 –∑–∞–ø—Ä–æ—Å–æ–≤ = ~$3
- 100,000 –∑–∞–ø—Ä–æ—Å–æ–≤ = ~$30

---

## üéØ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### 3 —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã:

‚úÖ **General** - –û–±—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã –ø–æ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º—É  
‚úÖ **Lesson** - –ü–æ–º–æ—â—å –ø–æ —Ç–µ–∫—É—â–µ–º—É —É—Ä–æ–∫—É  
‚úÖ **Practice** - –ü—Ä–∞–∫—Ç–∏–∫–∞ —Ä–∞–∑–≥–æ–≤–æ—Ä–Ω–æ–π —Ä–µ—á–∏

### –£–º–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç:

‚úÖ –ü–æ–º–Ω–∏—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 —Å–æ–æ–±—â–µ–Ω–∏–π  
‚úÖ –†–∞–∑–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–∂–∏–º–∞  
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ suggestions –ø–æ—Å–ª–µ –æ—Ç–≤–µ—Ç–∞  
‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤–≤–æ–¥–∞ (–º–∞–∫—Å 1000 —Å–∏–º–≤–æ–ª–æ–≤)

---

## üõ†Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –ò–∑–º–µ–Ω–∏—Ç—å –º–æ–¥–µ–ª—å

–í —Ñ–∞–π–ª–µ `src/app/api/tutor/chat/route.ts`:

```typescript
const completion = await openai.chat.completions.create({
  model: "gpt-4o-mini", // –∏–ª–∏ "gpt-4", "gpt-4-turbo"
  // ...
});
```

### –ò–∑–º–µ–Ω–∏—Ç—å —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É (–∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å)

```typescript
temperature: 0.7, // 0.0 = —Ç–æ—á–Ω—ã–µ, 1.0 = –∫—Ä–µ–∞—Ç–∏–≤–Ω—ã–µ
```

### –ò–∑–º–µ–Ω–∏—Ç—å –¥–ª–∏–Ω—É –æ—Ç–≤–µ—Ç–∞

```typescript
max_tokens: 1000, // –º–∞–∫—Å —Ç–æ–∫–µ–Ω–æ–≤ –≤ –æ—Ç–≤–µ—Ç–µ
```

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### Rate Limiting (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–î–æ–±–∞–≤—å—Ç–µ –≤ `src/app/api/tutor/chat/route.ts`:

```typescript
// –ü—Ä–æ—Å—Ç–æ–π rate limiter
const rateLimits = new Map<string, number[]>();

function checkRateLimit(userId: string): boolean {
  const now = Date.now();
  const userRequests = rateLimits.get(userId) || [];

  // –û—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –∑–∞–ø—Ä–æ—Å—ã –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 15 –º–∏–Ω—É—Ç
  const recentRequests = userRequests.filter(
    (time) => now - time < 15 * 60 * 1000
  );

  if (recentRequests.length >= 50) {
    return false; // –ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç
  }

  recentRequests.push(now);
  rateLimits.set(userId, recentRequests);
  return true;
}

// –í POST handler:
if (!checkRateLimit(userId || session?.user?.id || "anon")) {
  return NextResponse.json({ error: "Too many requests" }, { status: 429 });
}
```

---

## üêõ Troubleshooting

### –û—à–∏–±–∫–∞: "Invalid API key"

**–†–µ—à–µ–Ω–∏–µ:**

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–ª—é—á –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `sk-`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–ª—é—á –≤ `.env` –±–µ–∑ –ª–∏—à–Ω–∏—Ö –ø—Ä–æ–±–µ–ª–æ–≤
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ `npm run dev`

### –û—à–∏–±–∫–∞: "Rate limit exceeded"

**–†–µ—à–µ–Ω–∏–µ:**

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–ª–∞–Ω—Å –Ω–∞ https://platform.openai.com/account/billing
2. –ü–æ–¥–æ–∂–¥–∏—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç
3. –£–º–µ–Ω—å—à–∏—Ç–µ —á–∞—Å—Ç–æ—Ç—É –∑–∞–ø—Ä–æ—Å–æ–≤

### –û—à–∏–±–∫–∞: "Module not found: openai"

**–†–µ—à–µ–Ω–∏–µ:**

```bash
npm install openai
npm run dev
```

### –ß–∞—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç

**–†–µ—à–µ–Ω–∏–µ:**

1. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—à–∏–±–∫–∏
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ Next.js
4. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ API –∫–ª—é—á –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∞—Å—Ö–æ–¥–æ–≤

### OpenAI Dashboard

–û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞:
https://platform.openai.com/account/usage

### –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ª–∏–º–∏—Ç—ã

1. –û—Ç–∫—Ä–æ–π—Ç–µ: https://platform.openai.com/account/limits
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ **Monthly budget limit**
3. –í–∫–ª—é—á–∏—Ç–µ **Email notifications**

---

## üöÄ Production Deploy

### Vercel

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Vercel CLI
npm i -g vercel

# –î–µ–ø–ª–æ–π
vercel

# –î–æ–±–∞–≤—å—Ç–µ env variable –≤ Vercel Dashboard:
OPENAI_API_KEY=sk-...
```

### Railway

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Railway CLI
npm i -g @railway/cli

# –î–µ–ø–ª–æ–π
railway up

# –î–æ–±–∞–≤—å—Ç–µ env variable:
railway variables set OPENAI_API_KEY=sk-...
```

---

## üìà –£–ª—É—á—à–µ–Ω–∏—è

### 1. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –≤ –ë–î

–û–±–Ω–æ–≤–∏—Ç–µ Prisma schema:

```prisma
model ChatMessage {
  id             String   @id @default(cuid())
  userId         String
  role           String
  content        String
  mode           String
  timestamp      DateTime @default(now())
}
```

### 2. –ì–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥

```typescript
// –í ChatInterface.tsx
const recognition = new webkitSpeechRecognition();
recognition.lang = "en-US";
recognition.onresult = (e) => {
  setInput(e.results[0][0].transcript);
};
```

### 3. Streaming –æ—Ç–≤–µ—Ç–æ–≤

```typescript
const stream = await openai.chat.completions.create({
  model: "gpt-4o-mini",
  messages: messages,
  stream: true,
});

for await (const chunk of stream) {
  const content = chunk.choices[0]?.delta?.content;
  // –û—Ç–ø—Ä–∞–≤–ª—è–π—Ç–µ chunk –∫–ª–∏–µ–Ω—Ç—É
}
```

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç

- [ ] OpenAI API –∫–ª—é—á –ø–æ–ª—É—á–µ–Ω
- [ ] –ö–ª—é—á –¥–æ–±–∞–≤–ª–µ–Ω –≤ `.env`
- [ ] `npm install openai` –≤—ã–ø–æ–ª–Ω–µ–Ω
- [ ] `npm run dev` –∑–∞–ø—É—â–µ–Ω
- [ ] –ß–∞—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ `/tutor`
- [ ] –í—Å–µ 3 —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç–∞—é—Ç
- [ ] Suggestions –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è
- [ ] –ò—Å—Ç–æ—Ä–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è (UI)

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

### API Documentation

- **OpenAI Chat API:** https://platform.openai.com/docs/api-reference/chat
- **OpenAI Node SDK:** https://github.com/openai/openai-node

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–æ–¥–µ–ª–∏

```typescript
// GPT-4 Turbo (–±—ã—Å—Ç—Ä–µ–µ GPT-4)
model: "gpt-4-turbo";

// GPT-4 (—Å–∞–º–æ–µ –≤—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ)
model: "gpt-4";

// GPT-3.5 Turbo (–¥–µ—à–µ–≤–ª–µ)
model: "gpt-3.5-turbo";
```

---

**üéâ –í–∞—à –ò–ò —Ä–µ–ø–µ—Ç–∏—Ç–æ—Ä –≥–æ—Ç–æ–≤!**

**–ù–∞—á–Ω–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:** http://localhost:3001/tutor

---

**–í–µ—Ä—Å–∏—è:** 2.0 (–±–µ–∑ n8n)  
**–û–±–Ω–æ–≤–ª–µ–Ω–æ:** –ù–æ—è–±—Ä—å 2025
